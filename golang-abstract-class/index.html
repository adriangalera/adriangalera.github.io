<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    <!-- Main JS (navbar.js, katex_init.js and masonry_init.js)-->
    <script defer=true src="/assets/js/main.min.js"></script>
    
    <!-- CSS -->
    <link rel="stylesheet" href="/assets/css/main.css">

    <!--Favicon-->
    <link rel="shortcut icon" href="/assets/img/avatars/me-100x100.png" type="image/x-icon">

    <!-- Canonical -->
    <!--link rel="canonical" href="https://www.agalera.eu/golang-abstract-class/" -->

    <!-- RSS -->
    <link rel="alternate" type="application/atom+xml" title="Adrian Galera blog" href="https://www.agalera.eu/feed.xml"/>
    
    

    <!-- KaTeX 0.8.3 -->
    <!-- if you have any issue check https://github.com/KaTeX/KaTeX -->
    
    <script src="/assets/js/vendor/katex.min.js"></script>
    

    <!-- Google Analytics -->
    
    
    <script>
        (function(i, s, o, g, r, a, m) {
            i['GoogleAnalyticsObject'] = r;
            i[r] = i[r] || function() {
                (i[r].q = i[r].q || []).push(arguments)
            }, i[r].l = 1 * new Date();
            a = s.createElement(o),
                m = s.getElementsByTagName(o)[0];
            a.async = 1;
            a.src = g;
            m.parentNode.insertBefore(a, m)
        })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');

        ga('create', 'UA-126206451-1', 'auto');
        ga('send', 'pageview');

    </script>
    
    
    
    <!-- seo tags -->
    <!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Golang abstract class | Adrian Galera blog</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Golang abstract class" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="How to implement an abstract class on golang" />
<meta property="og:description" content="How to implement an abstract class on golang" />
<link rel="canonical" href="https://www.agalera.eu/golang-abstract-class/" />
<meta property="og:url" content="https://www.agalera.eu/golang-abstract-class/" />
<meta property="og:site_name" content="Adrian Galera blog" />
<meta property="og:image" content="https://www.agalera.eu/assets/img/posts/golang-abstract/featured-image.jpg" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-09-24T00:00:00+02:00" />
<script type="application/ld+json">
{"headline":"Golang abstract class","dateModified":"2021-09-24T00:00:00+02:00","url":"https://www.agalera.eu/golang-abstract-class/","datePublished":"2021-09-24T00:00:00+02:00","image":"https://www.agalera.eu/assets/img/posts/golang-abstract/featured-image.jpg","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.agalera.eu/golang-abstract-class/"},"description":"How to implement an abstract class on golang","@type":"BlogPosting","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

    <!-- Manual seo tags -->
    <!--
    <title>Golang abstract class | Adrian Galera blog</title>
    <meta name="description" content="I’m doing a side project using golang, and I have a use case where I’d use an abstract class in Java.  Unfortunately, in golang the concept of classes does n...">
    -->
</head>

  <body>
    <header class="site-header">
    
    <!-- Logo and title -->
	<div class="branding">
		<a href="/">
			<img alt="logo img" class="avatar" src="/assets/img/avatars/me-100x100.png" />
		</a>

		<h1 class="site-title">
			<a aria-label="Adrian Galera blog" href="/">
        Adrian Galera blog
      </a>
		</h1>
	</div>
    
    <!-- Toggle menu -->
    <nav class="clear">
    <a aria-label="pull" id="pull" class="toggle" href="#">
    <i class="fa fa-bars fa-lg"></i>
    </a>
    
    <!-- Menu -->
    <ul class="hide">
        
        
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            <li class="separator"> | </li>
            <li>
                <a class="clear" aria-label="Search" title="Search" href="/search/">
                     <i class="fa fa-search" aria-hidden="true"></i>
                    
                </a>
            </li>
            
            
        
            
            
        
            
            <li class="separator"> | </li>
            <li>
                <a class="clear" aria-label="Tags" title="Tags" href="/tags/">
                     <i class="fa fa-tags" aria-hidden="true"></i>
                    
                </a>
            </li>
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
    </ul>
        
	</nav>
</header>

    <div class="content">
      <article class="feature-image">
  <header id="main" style="">
    
      <h2 id="Golang+abstract+class" class="title">Golang abstract class</h2>
      

<div class="post-info"><a href="https://www.agalera.eu" target="_blank">
    <p class="meta">
      Adrian Galera - September 24, 2021
    </p></a></div>

    
  </header>
  <section class="post-content">
  
      <p>I’m doing a side project using golang, and I have a use case where I’d use an abstract class in Java.  Unfortunately, in golang the concept of classes does not exist.</p>

<p>In this article I describe how can I implement the behaviour I want without abstract class.</p>

<p><!--more--></p>

<p>I’m implementing an alert system in golang. When the alert needs to be activated, I want to play a sound through speakers and blink some LEDs for some period of time.</p>

<p>The behavior is quite simple, it needs to provide an implementation to enable the signaler, disable and query.</p>

<p>We will create two clases, one for playing sounds and another one for blinking the LEDs. And an abstract class to implement the shutdown after some period of time. Something similar to:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">abstract</span> <span class="kd">class</span> <span class="nc">Signaler</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">enableForTime</span><span class="o">(</span><span class="kt">int</span> <span class="n">seconds</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">//Implementation to enable the signaler for x seconds</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">disable</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">//Disable the signalers and cancel any pending timer</span>
    <span class="o">}</span>
    <span class="kd">abstract</span> <span class="kt">void</span> <span class="nf">enable</span><span class="o">();</span>
    <span class="kd">abstract</span> <span class="kt">void</span> <span class="nf">disableSignaler</span><span class="o">();</span>
<span class="o">}</span>
<span class="kd">class</span> <span class="nc">LedSignaler</span> <span class="kd">extends</span> <span class="nc">Signaler</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kt">void</span> <span class="nf">enable</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">//enable the LEDs</span>
    <span class="o">}</span>
    <span class="nd">@Override</span>
    <span class="kt">void</span> <span class="nf">disableSignaler</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">//disable the LEDs</span>
    <span class="o">}</span>
<span class="o">}</span>
<span class="kd">class</span> <span class="nc">SoundSignaler</span> <span class="kd">extends</span> <span class="nc">Signaler</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kt">void</span> <span class="nf">enable</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">//enable the speaker</span>
    <span class="o">}</span>
    <span class="nd">@Override</span>
    <span class="kt">void</span> <span class="nf">disableSignaler</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">//disable the speaker</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>The idea of this is to abstract the concrete implementation to the caller of the signaler.</p>

<p>This representation will work in any language that supports inheritance and abstract classes.</p>

<h2 id="decorator-pattern">Decorator pattern</h2>

<p>In golang, the concept of classes does not exist. So, we need to re-architecture the pattern.</p>

<p>Instead of using the abstract class, we can re-think the implementation to use a decorator pattern: <a href="https://en.wikipedia.org/wiki/Decorator_pattern">https://en.wikipedia.org/wiki/Decorator_pattern</a>.</p>

<blockquote>
  <p>The decorator pattern is a design pattern that allows behavior to be added to an individual object, dynamically, without affecting the behavior of other objects from the same class</p>
</blockquote>

<p>It works by defining an interface that will have multiple implementation, we can add new functionalities by adding new implementations. Let’s go define the interface of the signaler:</p>

<div class="language-golang highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">type</span> <span class="n">Signaler</span> <span class="k">interface</span> <span class="p">{</span>
	<span class="n">Enable</span><span class="p">()</span>
	<span class="n">IsEnabled</span><span class="p">()</span> <span class="kt">bool</span>
	<span class="n">Disable</span><span class="p">()</span>
<span class="p">}</span>
</code></pre></div></div>
<p>Now, we can do the implementation of the sound signaler. To implement and interface in golang you need to provide a struct that has the same methods as the interface.</p>

<div class="language-golang highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">type</span> <span class="n">soundSignaler</span> <span class="k">struct</span> <span class="p">{</span>
    
<span class="p">}</span>
<span class="k">func</span> <span class="p">(</span><span class="n">s</span> <span class="o">*</span><span class="n">soundSignaler</span><span class="p">)</span> <span class="n">Enable</span><span class="p">()</span> <span class="p">{</span>
	<span class="n">s</span><span class="o">.</span><span class="n">enabled</span> <span class="o">=</span> <span class="no">true</span>
    <span class="c">//start playing sound</span>
<span class="p">}</span>

<span class="k">func</span> <span class="p">(</span><span class="n">s</span> <span class="o">*</span><span class="n">soundSignaler</span><span class="p">)</span> <span class="n">Disable</span><span class="p">()</span> <span class="p">{</span>
	<span class="n">s</span><span class="o">.</span><span class="n">enabled</span> <span class="o">=</span> <span class="no">false</span>
    <span class="c">//stop playing sound</span>
<span class="p">}</span>

<span class="k">func</span> <span class="p">(</span><span class="n">s</span> <span class="o">*</span><span class="n">soundSignaler</span><span class="p">)</span> <span class="n">IsEnabled</span><span class="p">()</span> <span class="kt">bool</span> <span class="p">{</span>
	<span class="k">return</span> <span class="n">s</span><span class="o">.</span><span class="n">enabled</span>
<span class="p">}</span>
</code></pre></div></div>
<p>OK, now let’s do the implementation of the temporal execution of the signaler. In order to do so, let’s create a new type that implement <code class="highlighter-rouge">Signaler</code>:</p>

<div class="language-golang highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">type</span> <span class="n">temporalSignaler</span> <span class="k">struct</span> <span class="p">{</span>
	<span class="n">config</span>          <span class="o">*</span><span class="n">config</span><span class="o">.</span><span class="n">AlarmConfig</span>
	<span class="n">timers</span>          <span class="p">[]</span><span class="n">signalerTimer</span>
	<span class="n">delayedExecutor</span> <span class="n">delayedExecutor</span>
	<span class="n">signaler</span>        <span class="n">Signaler</span>
<span class="p">}</span>

<span class="k">func</span> <span class="p">(</span><span class="n">s</span> <span class="o">*</span><span class="n">temporalSignaler</span><span class="p">)</span> <span class="n">Enable</span><span class="p">()</span> <span class="p">{</span>
	<span class="n">s</span><span class="o">.</span><span class="n">signaler</span><span class="o">.</span><span class="n">Enable</span><span class="p">()</span>
	<span class="k">var</span> <span class="n">t</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">delayedExecutor</span><span class="o">.</span><span class="n">executeAfterSeconds</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">SecondsStopSignals</span><span class="p">,</span> <span class="k">func</span><span class="p">()</span> <span class="p">{</span>
		<span class="n">s</span><span class="o">.</span><span class="n">Disable</span><span class="p">()</span>
	<span class="p">})</span>
	<span class="n">s</span><span class="o">.</span><span class="n">timers</span> <span class="o">=</span> <span class="nb">append</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">timers</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<span class="p">}</span>

<span class="k">func</span> <span class="p">(</span><span class="n">s</span> <span class="o">*</span><span class="n">temporalSignaler</span><span class="p">)</span> <span class="n">Disable</span><span class="p">()</span> <span class="p">{</span>
	<span class="k">for</span> <span class="n">i</span> <span class="o">:=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">timers</span><span class="p">);</span> <span class="n">i</span><span class="o">++</span> <span class="p">{</span>
		<span class="n">s</span><span class="o">.</span><span class="n">timers</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">Stop</span><span class="p">()</span>
	<span class="p">}</span>
	<span class="n">s</span><span class="o">.</span><span class="n">signaler</span><span class="o">.</span><span class="n">Disable</span><span class="p">()</span>
<span class="p">}</span>

<span class="k">func</span> <span class="p">(</span><span class="n">s</span> <span class="o">*</span><span class="n">temporalSignaler</span><span class="p">)</span> <span class="n">IsEnabled</span><span class="p">()</span> <span class="kt">bool</span> <span class="p">{</span>
	<span class="k">return</span> <span class="n">s</span><span class="o">.</span><span class="n">signaler</span><span class="o">.</span><span class="n">IsEnabled</span><span class="p">()</span>
<span class="p">}</span>
</code></pre></div></div>
<p>The key point of this struct, is that we’re holding a <code class="highlighter-rouge">Signaler</code> instance on it. We are “decorating” that instance with the temporal disabling functionality. In order to do so, we just need to implement the logic in the type and call the <code class="highlighter-rouge">Signaler</code> methods of the decorated instance.</p>

<p>The most elegant part of this implementation is that we’re defining all the structs as private (name begins with lower case). So, the external modules cannot instantiate them. We can abstract the creation of the sound signaler by creating a factory:</p>

<div class="language-golang highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">func</span> <span class="n">NewSoundSignaler</span><span class="p">(</span><span class="n">config</span> <span class="o">*</span><span class="n">config</span><span class="o">.</span><span class="n">Config</span><span class="p">)</span> <span class="n">Signaler</span> <span class="p">{</span>
	<span class="k">return</span> <span class="o">&amp;</span><span class="n">temporalSignaler</span><span class="p">{</span>
		<span class="n">delayedExecutor</span><span class="o">:</span> <span class="o">&amp;</span><span class="n">defaultDelayedExecutor</span><span class="p">{},</span>
		<span class="n">config</span><span class="o">:</span>          <span class="o">&amp;</span><span class="n">config</span><span class="o">.</span><span class="n">Alarm</span><span class="p">,</span>
		<span class="n">signaler</span><span class="o">:</span> <span class="o">&amp;</span><span class="n">soundSignaler</span><span class="p">{</span>
			<span class="n">config</span><span class="o">:</span>   <span class="n">config</span><span class="p">,</span>
			<span class="n">executor</span><span class="o">:</span> <span class="o">&amp;</span><span class="n">unixCommandExecutor</span><span class="p">{},</span>
		<span class="p">},</span>
	<span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>External modules can call the factory method, and they will receive a <code class="highlighter-rouge">Signaler</code> instance, hiding effectively the implementation details of the temporal execution and sound playback.</p>

    
  </section>

  <!-- Social media shares -->
  <div class="share-buttons">
    <ul class="share-buttons">
        <div class="meta">Share</div>
        
        <li>
            <a href="https://www.facebook.com/sharer/sharer.php?u=https://www.agalera.eu/golang-abstract-class/" target="_blank" title="Share on Facebook">
			<i class="fa fa-facebook-square fa-2x" aria-hidden="true"></i>
			<span class="sr-only">Share on Facebook</span>
		</a>
        </li>
         
        <li>
            <a href="https://twitter.com/intent/tweet?source=https://www.agalera.eu/golang-abstract-class/&text=Golang+abstract+class%20%7C%20Adrian+Galera+blog:%20https://www.agalera.eu/golang-abstract-class/" target="_blank" title="Tweet">
			<i class="fa fa-twitter-square fa-2x" aria-hidden="true"></i>
			<span class="sr-only">Tweet</span>
		</a>
        </li>
                
        <li>
            <a href="mailto:?subject=Golang+abstract+class%20%7C%20Adrian+Galera+blog&body=:%20https://www.agalera.eu/golang-abstract-class/" target="_blank" title="Email">
			<i class="fa fa-envelope-square fa-2x" aria-hidden="true"></i>
			<span class="sr-only">Email</span>
		</a>
        </li>
        
    </ul>
</div>

   <!-- Tag list -->
  
  


<footer>
  <div class="tag-list">
    
      <div class="meta">Tags</div>
    

    
    <a class="button" href="/tags#architecture">
      <p><i class="fa fa-tag fa-fw"></i> architecture</p>
    </a>
    
    <a class="button" href="/tags#design+patterns">
      <p><i class="fa fa-tag fa-fw"></i> design patterns</p>
    </a>
    
    <a class="button" href="/tags#golang">
      <p><i class="fa fa-tag fa-fw"></i> golang</p>
    </a>
    
  </div>
</footer>


</article>

<!-- Disqus -->


<!-- Post navigation -->

  <div id="post-nav">
    
    

    <div id="next-post">
        <p>Previous post</p>
        <a alt="Implementing a dog bark detector" href="/bark-detector/">
            Implementing a dog bark detector
        </a>
    </div>
    
</div>



<!-- To change color of links in the page -->
<style>
  

  
  header#main {
    background-repeat:no-repeat;
    background-image: url('/assets/img/posts/golang-abstract/featured-image.jpg');
  }
</style>
    </div>
    



  </body>
</html>
