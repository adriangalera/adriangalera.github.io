<!DOCTYPE html>
<!--
    Type on Strap jekyll theme v2.4.3
    Theme free for personal and commercial use under the MIT license
    https://github.com/sylhare/Type-on-Strap/blob/master/LICENSE
-->
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=0.5, maximum-scale=5">

    <!-- Theme Mode-->
    
    <script>
        const isAutoTheme = true;
        document.documentElement.setAttribute('data-theme', sessionStorage.getItem('theme'))
    </script>
    

    <!-- Main JS (navbar.js, katex_init.js and masonry_init.js)-->
    <script defer src="/assets/js/main.min.js"></script>

    <!-- CSS -->
    <link rel="stylesheet" href="/assets/css/main.css">

    <!--Favicon-->
    <link rel="shortcut icon" href="/assets/img/avatars/me-100x100.png" type="image/x-icon">

    

    <!-- KaTeX 0.15.2 -->
    
    <script defer src="/assets/js/vendor/katex.min.js"></script>
    <script defer src="/assets/js/vendor/auto-render.min.js" onload="renderMathInElement(document.body);"></script>
    

    <!-- Mermaid 9.1.1 -->
    
    <script defer src="/assets/js/vendor/mermaid.min.js" onload="mermaid.initialize({
      startOnLoad:true,
      theme: 'default',
    });"></script>
    

    <!-- Simple Jekyll Search 1.10.0 -->
    <script src="/assets/js/vendor/simple-jekyll-search.min.js" type="text/javascript"></script>

    <!-- Google Analytics / Cookie Consent -->
    <script>
      const cookieName = 'cookie-notice-dismissed-https://www.agalera.eu';
      const isCookieConsent = 'false';
      const analyticsName = 'UA-126206451-1';
      const analyticsNameGA4 = '';
    </script>

    
    
        <!-- old google analytics -->
        <!--
        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-126206451-1"></script>
        <script async src='https://www.google-analytics.com/analytics.js'></script>
        <script>
        // disable GA for localhost
        const isProduction = window.location.host.includes("agalera.eu")
        if (!isProduction) { 
          console.log(`Disabling google analytics for UA-126206451-1`)
          window['ga-disable-UA-126206451-1'] = true;
        }
        </script>
        -->
        <!-- Google tag (gtag.js) -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-S8VGYBN25C"></script>
        <script>
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());

          gtag('config', 'G-S8VGYBN25C');
        </script>        
    

    <!-- seo tags -->
    <meta property="og:image" content="https://www.agalera.eu/assets/img/posts/hack-the-box-cheatsheet/featured.jpg">
    
    <meta property="og:type" content="website" />
    
    <!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Pentesting tools | Adrian Galera blog</title>
<meta name="generator" content="Jekyll v4.3.1" />
<meta property="og:title" content="Pentesting tools" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="I keep this page as a reference to the different tools I have learnt in https://www.hackthebox.com/" />
<meta property="og:description" content="I keep this page as a reference to the different tools I have learnt in https://www.hackthebox.com/" />
<link rel="canonical" href="https://www.agalera.eu/pentesting-tools/" />
<meta property="og:url" content="https://www.agalera.eu/pentesting-tools/" />
<meta property="og:site_name" content="Adrian Galera blog" />
<meta property="og:image" content="https://www.agalera.eu/assets/img/posts/hack-the-box-cheatsheet/featured.jpg" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-12-16T00:00:00+01:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="https://www.agalera.eu/assets/img/posts/hack-the-box-cheatsheet/featured.jpg" />
<meta property="twitter:title" content="Pentesting tools" />
<script type="application/ld+json">
{"image":"https://www.agalera.eu/assets/img/posts/hack-the-box-cheatsheet/featured.jpg","url":"https://www.agalera.eu/pentesting-tools/","headline":"Pentesting tools","@type":"BlogPosting","datePublished":"2022-12-16T00:00:00+01:00","description":"I keep this page as a reference to the different tools I have learnt in https://www.hackthebox.com/","dateModified":"2022-12-16T00:00:00+01:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.agalera.eu/pentesting-tools/"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <!-- RSS -->
    <link rel="alternate" type="application/atom+xml" title="Adrian Galera blog" href="https://www.agalera.eu/feed.xml"/>
    <link type="application/atom+xml" rel="alternate" href="https://www.agalera.eu/feed.xml" title="Adrian Galera blog" />

    <!-- Twitter Cards -->
    <meta name="twitter:title" content="Pentesting tools">
    <meta name="twitter:description" content="I have started playing around in https://www.hackthebox.com platform and I’ll use this article to save all the pentesting tools I am learning.nmapnmap is a p...">
    
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="https://www.agalera.eu/assets/img/posts/hack-the-box-cheatsheet/featured.jpg">
    <meta name="twitter:image:alt" content="Pentesting tools">
</head>

  <body>
    <header class="site-header">

    <!-- Logo and title -->
	<div class="branding">
        
		<a href="/">
			<img alt="logo img" class="avatar" src="/assets/img/avatars/me-100x100.png" />
		</a>
        
        <a class="site-title" aria-label="Adrian Galera blog" href="/">
        Adrian Galera blog
		</a>
	</div>

    <!-- Toggle menu -->
    <nav class="clear">
    <a aria-label="pull" id="pull" class="toggle" href="#">
    <i class="fas fa-bars fa-lg"></i>
    </a>

    <!-- Menu -->
    <ul class="hide">
        

        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            <li class="separator"> | </li>
            <li>
                <a class="clear" aria-label="Search" title="Search" href="/search/">
                     <i class="fas fa-search" aria-hidden="true"></i>
                    
                </a>
            </li>
            
            
        
            
            <li class="separator"> | </li>
            <li>
                <a class="clear" aria-label="Tags" title="Tags" href="/tags/">
                     <i class="fas fa-tags" aria-hidden="true"></i>
                    
                </a>
            </li>
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
        
        
        <li class="separator"> | </li>
        <li><a id="theme-toggle" title="Pentesting tools " aria-label="Pentesting tools" onclick="themeToggle()"></a></li>
        
    </ul>

	</nav>
</header>

    <div class="content">
      <article class="feature-image" >
  <header id="main" style="">
    <div class="title-padder">
      
      <h1 id="Pentesting+tools" class="title">Pentesting tools</h1>
      


<div class="post-info">
    <p class="meta">
      
      
      December 16, 2022
    </p></div>

      
    </div>
  </header>

  <section class="post-content">
  
      <p>I have started playing around in <a href="https://www.hackthebox.com/">https://www.hackthebox.com</a> platform and I’ll use this article to save all the pentesting tools I am learning.</p>

<p><!--more--></p>

<h2 id="nmap">nmap</h2>

<p>nmap is a port scanner tool. By default it scan ports from 0-1000.</p>

<p>You should pass the <code class="language-plaintext highlighter-rouge">-A</code> flag which enables OS detection, version detection, script scanning, and traceroute:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nmap -A &lt;ip&gt;
</code></pre></div></div>

<p>To enable only service version detection:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nmap -sV &lt;ip&gt;
</code></pre></div></div>

<p>-sV flag does scanning and prints service and version on the found open port</p>

<p>To specify the default set of scripts for version identification use <code class="language-plaintext highlighter-rouge">-sC</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nmap -sC &lt;ip&gt;
</code></pre></div></div>

<p>To scan all the ports, we need to specify this flags:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>namp -sV -p- --min-rate 1000 &lt;ip&gt;
</code></pre></div></div>

<p>Take into account that this operation will take a long time to complete.</p>

<p><code class="language-plaintext highlighter-rouge">--min-rate</code> speeds up the process by sending packets not slower than X messages per second.</p>

<p>Be aware that this might trigger some suspicion on IDS, for that, check the <code class="language-plaintext highlighter-rouge">-T0</code> or <code class="language-plaintext highlighter-rouge">-T1</code> flag.</p>

<p>If nmap reports he has issues because could not determine if port open or closed. The machine might be protected by a firewall, instead of performing a TCP SYN scan, you can use a TCP FIN scan by providing the flag <code class="language-plaintext highlighter-rouge">-sF</code></p>

<p>You can disable DNS resolution with <code class="language-plaintext highlighter-rouge">-n</code></p>

<p>You can generate a nice report by using the <code class="language-plaintext highlighter-rouge">-oX</code> flag and <code class="language-plaintext highlighter-rouge">--webxml</code>, e.g.:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nmap -p- -sC -sV -n --min-rate 1000 10.129.95.187 -oX nmap_allPorts --webxml
</code></pre></div></div>

<p>You can disable ping scan (blocked by firewalls) by disabling host discovery: <code class="language-plaintext highlighter-rouge">-Pn</code>.</p>

<h2 id="telnet">telnet</h2>

<p>Telnet is a very old way of connecting to computer and by default listens on port 23.</p>

<p>Usage:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>telnet &lt;ip&gt;
</code></pre></div></div>

<p>The prompty will ask for user/password:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>telnet &lt;ip&gt;
Trying &lt;ip&gt;...
Connected to &lt;ip&gt;.
Escape character is '^]'.

  █  █         ▐▌     ▄█▄ █          ▄▄▄▄
  █▄▄█ ▀▀█ █▀▀ ▐▌▄▀    █  █▀█ █▀█    █▌▄█ ▄▀▀▄ ▀▄▀
  █  █ █▄█ █▄▄ ▐█▀▄    █  █ █ █▄▄    █▌▄█ ▀▄▄▀ █▀█


Meow login: root
</code></pre></div></div>

<h2 id="ftp">ftp</h2>

<p>Stands for File transfer protocol. It listens on port 21 by deault and is unencrypted (the secure version is called sftp)</p>

<p>The first thing to try while trying to access ftp is user <code class="language-plaintext highlighter-rouge">anonymous</code> whitout password.</p>

<p>Commands:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">ls</code>: list directory contents</li>
  <li><code class="language-plaintext highlighter-rouge">pass</code>: set passive mode</li>
  <li><code class="language-plaintext highlighter-rouge">get</code>: retrieve file to computer</li>
</ul>

<p>Examples</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ftp &lt;ip&gt;
Connected to &lt;ip&gt;.
220 (vsFTPd 3.0.3)
Name (&lt;ip&gt;:gal): anonymous
331 Please specify the password.
Password:
230 Login successful.
Remote system type is UNIX.
Using binary mode to transfer files.
ftp&gt; ls
500 Illegal PORT command.
ftp: bind: Address already in use
ftp&gt; pass
Passive mode on.
ftp&gt; ls
227 Entering Passive Mode (10,129,103,239,82,68).
150 Here comes the directory listing.
-rw-r--r--    1 0        0              32 Jun 04  2021 flag.txt
226 Directory send OK.
ftp&gt; get flag.txt /tmp/flag.txt
local: /tmp/flag.txt remote: flag.txt
227 Entering Passive Mode (10,129,103,239,159,232).
150 Opening BINARY mode data connection for flag.txt (32 bytes).
226 Transfer complete.
32 bytes received in 0.00 secs (21.1291 kB/s)
</code></pre></div></div>

<ul>
  <li>in order to use the <code class="language-plaintext highlighter-rouge">ls</code> command, we need to set the Passive mode by issuing the <code class="language-plaintext highlighter-rouge">pass</code> command</li>
</ul>

<p>Download all contents of ftp-server:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>wget -m ftp://username:password@ip.of.old.host
</code></pre></div></div>

<p>To see hidden files:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ls -la
</code></pre></div></div>

<h2 id="smb">smb</h2>

<p>Stands for Server Message Block and is a protocol for file sharing between computers. It runs on port 445 by default.</p>

<p>The command line tool to interact with it, it’s <code class="language-plaintext highlighter-rouge">smbclient</code>.</p>

<p>To list shared directories:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>smbclient -L \\&lt;ip&gt;
Enter WORKGROUP\gal's password:

        Sharename       Type      Comment
        ---------       ----      -------
        ADMIN$          Disk      Remote Admin
        C$              Disk      Default share
        IPC$            IPC       Remote IPC
        WorkShares      Disk
SMB1 disabled -- no workgroup available
</code></pre></div></div>

<p>Note the <code class="language-plaintext highlighter-rouge">\\</code> prefix, this comes from Windows slahes. Make sure to pass the <code class="language-plaintext highlighter-rouge">--user</code> flag, otherwise it will try to connect using your Linux user:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>smbclient -L \\10.129.68.251 --user="Administrator"
Password for [WORKGROUP\Administrator]:

	Sharename       Type      Comment
	---------       ----      -------
	ADMIN$          Disk      Remote Admin
	C$              Disk      Default share
	IPC$            IPC       Remote IPC
</code></pre></div></div>

<p>Now, let’s connect to the shared:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>smbclient \\\\&lt;ip&gt;\\WorkShares
Enter WORKGROUP\gal's password:
Try "help" to get a list of possible commands.
smb: \&gt;
</code></pre></div></div>

<p>The commands to use once inside are the same as ftp</p>

<p>You can use <code class="language-plaintext highlighter-rouge">-N</code> flag to don’t use any password</p>

<p>If you see this error: <code class="language-plaintext highlighter-rouge">protocol negotiation failed: NT_STATUS_NOT_SUPPORTED</code>, you need to configure min/max protocol versions, see: <a href="https://unix.stackexchange.com/questions/562550/smbclient-protocol-negotiation-failed">https://unix.stackexchange.com/questions/562550/smbclient-protocol-negotiation-failed</a></p>

<h2 id="redis">redis</h2>

<p>Redis is an in-memory key-value (NoSQL) database running on 6379 port by default</p>

<p>To connect to the database, we must use <code class="language-plaintext highlighter-rouge">redis-cli</code>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>redis-cli -h &lt;ip&gt;
</code></pre></div></div>

<p>Once inside we can retrieve more information by using the <code class="language-plaintext highlighter-rouge">info</code> command:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;ip&gt;:6379&gt; info
# Server
redis_version:5.0.7
redis_git_sha1:00000000
redis_git_dirty:0
redis_build_id:66bd629f924ac924
redis_mode:standalone
os:Linux 5.4.0-77-generic x86_64
arch_bits:64
</code></pre></div></div>

<p>To enumerate the database with some entries, we can use the <code class="language-plaintext highlighter-rouge">info keyspace</code> command. This information is present in the <code class="language-plaintext highlighter-rouge">info</code> response as well.</p>

<p>To retrieve all the keys in a given database, we can use the <code class="language-plaintext highlighter-rouge">keys *</code> command once we have selected the database. To access a particular key, we use the <code class="language-plaintext highlighter-rouge">get</code> command:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>redis-cli -h &lt;ip&gt;
&lt;ip&gt;:6379&gt; select 0
OK
&lt;ip&gt;:6379&gt; keys *
1) "numb"
2) "temp"
3) "flag"
4) "stor"
&lt;ip&gt;:6379&gt; keys flag
1) "flag"
&lt;ip&gt;:6379&gt; get flag
"flag"
</code></pre></div></div>

<h2 id="rdp">rdp</h2>

<p>Stands for Remote Desktop Protocol and runs on port 3389.</p>

<p>To connect, you can use Windows tool or if in Linux, <code class="language-plaintext highlighter-rouge">xfreerdp</code> or any other alternative.</p>

<p>If checking a Windows machine, try first the <code class="language-plaintext highlighter-rouge">Administrator</code> user.</p>

<h2 id="mongodb">MongoDB</h2>

<p>MongoDB is a document based (NoSQL) database that runs by default on port 27017.</p>

<p>To connect to it, we should use the mongo shell, currently <code class="language-plaintext highlighter-rouge">mongosh</code>.</p>

<p>To show all the database in the instance, use the <code class="language-plaintext highlighter-rouge">show dbs</code> command.</p>

<p>To select a database: <code class="language-plaintext highlighter-rouge">use &lt;db&gt;</code></p>

<p>To show all the collections in a database use the <code class="language-plaintext highlighter-rouge">show collections</code> commands.</p>

<p>To show contents of all the documents inside a collection use the <code class="language-plaintext highlighter-rouge">db.&lt;collection&gt;.find().pretty()</code>. It will pretty print the results.</p>

<p>Example:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mongosh &lt;ip&gt;
Current Mongosh Log ID: 63999d00a5b1f19a65a9d84b
Connecting to:          mongodb://&lt;ip&gt;:27017/?directConnection=true&amp;appName=mongosh+1.6.1
Using MongoDB:          3.6.8
Using Mongosh:          1.6.1

For mongosh info see: https://docs.mongodb.com/mongodb-shell/

test&gt; show dbs
admin                  32.00 KiB
config                 72.00 KiB
local                  72.00 KiB
sensitive_information  32.00 KiB
users                  32.00 KiB
test&gt; show collections

test&gt; use sensitive_information
switched to db sensitive_information
sensitive_information&gt; show collections
flag
sensitive_information&gt; db.flag.find().pretty()
[
  {
    _id: ObjectId("630e3dbcb82540ebbd1748c5"),
    flag: 'flag'
  }
]
sensitive_information&gt;
</code></pre></div></div>

<h2 id="rsync">rsync</h2>

<p>rsync is a tool to share files between Linux machines, it defaults to SSH port (22) or 873.</p>

<p>With <code class="language-plaintext highlighter-rouge">rsync://</code> will use 873 port while the form <code class="language-plaintext highlighter-rouge">user@host</code> will use the SSH port</p>

<p>To list all the rsync shares:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rsync --list-only rsync://&lt;ip&gt;
public         	Anonymous Share
</code></pre></div></div>

<h2 id="gobuster">gobuster</h2>

<p>gobuster performs dir busting on a web server. It discovers available paths using a word list.</p>

<p>The following examples checks all the words in <code class="language-plaintext highlighter-rouge">/usr/share/dict/american-english-small</code> dictionary and searches for paths with <code class="language-plaintext highlighter-rouge">php</code> extensions and stores the results in <code class="language-plaintext highlighter-rouge">/tmp/found</code> and uses 20 threads:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gobuster -x php -u http://&lt;ip&gt; -w /usr/share/dict/american-english-small -o /tmp/found -t 20  
</code></pre></div></div>

<p>gobuster can also perform sub-domain enumeration (by dns records or by virtual host) e.g:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gobuster vhost --url http://thetoppers.htb -w /usr/share/workdlists/subdomains-top1million-5000.txt -t 50 --append-domain
</code></pre></div></div>

<p>Consider using different wordlist for subdomains and for directories</p>

<h2 id="responder">Responder</h2>

<p>the responder tool: <a href="https://github.com/lgandx/Responder">https://github.com/lgandx/Responder</a></p>

<p>For getting NTLM password, responder tool will setup a rogue SMB server that will capture the challenge initiated by another machine in the network and store the hash of the challenge.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sudo responder -I tun0
</code></pre></div></div>

<h2 id="john-the-ripper">John the ripper</h2>

<p>Password cracking tool. It does not do anything magic, it just compares a hash file with a list of words (dictionary). It has a quite decente default dictionary, however, you can search for more complete dictionaries such as the <a href="https://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=&amp;cad=rja&amp;uact=8&amp;ved=2ahUKEwi5noL2vP77AhXLXqQEHYafALkQFnoECA0QAQ&amp;url=https%3A%2F%2Fgithub.com%2Fbrannondorsey%2Fnaive-hashcat%2Freleases%2Fdownload%2Fdata%2Frockyou.txt&amp;usg=AOvVaw3snAERl1mU6Ccr4WFEazBd">rock you</a></p>

<p>Make sure to install a version &gt;= 1.9.0, which enables support for many hash formats. In my case for 1.8.0 version I couldn’t crack a NTLMv2 hash.</p>

<p>You can also use <code class="language-plaintext highlighter-rouge">zip2john</code> tool to brute-force zip files with passwords.</p>

<p>You can find here <a href="https://github.com/openwall/john">https://github.com/openwall/john</a>.</p>

<p>You can specify the format as well:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>john --format=raw-md5 passwd.txt
</code></pre></div></div>

<h2 id="evil-winrm">evil-winrm</h2>

<p>Once you know the user/password of a Windows target, you can use <a href="https://github.com/Hackplayers/evil-winrm">evil-winrm</a> to connect to the Powershell. Consider this tool as the PowerShell for Linux.</p>

<p>The usage is quite easy:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>evil-winrm -i 10.129.67.87 -u Administrator -p &lt;password&gt;
</code></pre></div></div>

<p>If you see some SSL error while connecting to the target make sure to enable support for legacy md4 hash:</p>

<p>Make sure the file <code class="language-plaintext highlighter-rouge">/etc/ssl/openssl.cnf</code> contains the following:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[provider_sect]
default = default_sect
legacy = legacy_sect

[default_sect]
activate = 1

[legacy_sect]
activate = 1
</code></pre></div></div>

<h2 id="postgres">postgres</h2>

<p>Basic commands (outisde of SQL queries):</p>

<p><code class="language-plaintext highlighter-rouge">\l</code> list databases
<code class="language-plaintext highlighter-rouge">\c db</code> connect to a database named <code class="language-plaintext highlighter-rouge">db</code>
<code class="language-plaintext highlighter-rouge">\dt</code> list tables on given database</p>

<h2 id="netcat">netcat</h2>

<p>Listen on 1234 port:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nc -lnvp 1234
</code></pre></div></div>

<p>-l : Listen mode</p>

<p>-n: numeric-only IP addresses, no dns</p>

<p>-v: verbose</p>

<p>-p: port - we can add p to say that we want to listen on a specific port (here 1234)</p>

<h2 id="impackets">impackets</h2>

<p><a href="https://github.com/fortra/impacket">https://github.com/fortra/impacket</a></p>

<p>Impacket is a collection of Python classes for working with network protocols</p>

<p>I’ve used it to exploit samba and mssql.</p>

<h3 id="mssqlclient">mssqlclient</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mssqlclient.py -windows-auth ARCHETYPE/sql_svc@10.129.95.187

SQL&gt; xp_cmdshell whoami
output                                                                             

--------------------------------------------------------------------------------   

archetype\sql_svc                                                                  

NULL                                                                               

SQL&gt; 

</code></pre></div></div>

<h2 id="wesg">wesg</h2>

<p><a href="https://github.com/bitsadmin/wesng">https://github.com/bitsadmin/wesng</a></p>

<p>Checks for Windows vulnerabilities given the output of a <code class="language-plaintext highlighter-rouge">systeminfo</code> command.</p>

<h2 id="burp-suite">Burp suite</h2>

<p><a href="https://portswigger.net/burp/communitydownload">https://portswigger.net/burp/communitydownload</a></p>

<p>This suite has a lot of nice features such:</p>

<ul>
  <li>Proxy</li>
  <li>Repeater</li>
  <li>Generating sitemap</li>
  <li>…</li>
</ul>

<h2 id="sqlmap">sqlmap</h2>

<p>Checks certain url for SQL injection vulnerabilities:</p>

<p>The easiest way is to capture traffic request to the possible vulnerable URL with burp and send it to sqlmap</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sqlmap -r search-request.txt
</code></pre></div></div>

<p>if you submit the <code class="language-plaintext highlighter-rouge">--os-shell</code> flag you’ll get a shell on the target</p>

<h2 id="interactive-shell">Interactive shell</h2>

<p>When doing reverse shells, the terminal is quite shitty and it lack basic features. In order to get a better shell, we could the following commands:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python3 -c 'import pty;pty.spawn("/bin/bash")'
----
stty raw -echo
fg
export TERM=xterm
</code></pre></div></div>

<h2 id="searchsploit">Searchsploit</h2>

<p>Once the enumeration succeded and you have the service and version, you can use <code class="language-plaintext highlighter-rouge">searchsploit</code> to search for possible sploits, see example:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>segal@gal-Modern-14-C12M:~<span class="nv">$ </span>searchsploit vsFTPd 2.3.4
<span class="nt">----------------------------------------------</span> <span class="nt">---------------------------------</span>
 Exploit Title                                |  Path
<span class="nt">----------------------------------------------</span> <span class="nt">---------------------------------</span>
vsftpd 2.3.4 - Backdoor Command Execution     | unix/remote/49757.py
vsftpd 2.3.4 - Backdoor Command Execution <span class="o">(</span>Me | unix/remote/17491.rb
<span class="nt">----------------------------------------------</span> <span class="nt">---------------------------------</span>
Shellcodes: No Results
</code></pre></div></div>

<h2 id="ghidra">Ghidra</h2>

<p>Is a decompiler/debugger tool very useful to analyse binaries and understand the logic inside</p>

<p><a href="https://github.com/NationalSecurityAgency/ghidra">https://github.com/NationalSecurityAgency/ghidra</a></p>

<h2 id="rsactftool">RsaCtfTool</h2>

<p>Is a tool to check/attack RSA keys.</p>

<p>I have used it to retrieve a private key from a weak RSA public key. The key pair are generated by multiplying two prime numbers, if the prime numbers are not big enough, they can be guessed and reveal the private key.</p>

<p>To decypher the file encrypted with the private key use <code class="language-plaintext highlighter-rouge">openssl</code>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>openssl rsautl -in flag.enc -out flag.txt -decrypt -inkey key.priv
</code></pre></div></div>

<p>To know the length of the RSA:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>openssl rsa -in key.pub --RSAPublicKey_in -text -noout
openssl rsa -in key.priv -text -noout
</code></pre></div></div>

<h2 id="gdb">gdb</h2>

<p><code class="language-plaintext highlighter-rouge">gdb</code> is the GNU debugger. See the following operations:</p>

<ul>
  <li>Set a breakpoint: <code class="language-plaintext highlighter-rouge">b *0x08049291</code></li>
  <li>Run the program: <code class="language-plaintext highlighter-rouge">r</code></li>
  <li>Run program with input: <code class="language-plaintext highlighter-rouge">r &lt; pattern.txt</code></li>
  <li>Continue the execution after breakpoint: <code class="language-plaintext highlighter-rouge">c</code></li>
  <li>Show file information: <code class="language-plaintext highlighter-rouge">info file</code></li>
  <li>Show stack: <code class="language-plaintext highlighter-rouge">x/60x $esp</code></li>
</ul>

<h2 id="gdb-peda">gdb-peda</h2>

<p>Python Exploit Development Assistance for GDB</p>

<p><a href="https://github.com/longld/peda">https://github.com/longld/peda</a></p>

<ul>
  <li>Create a pattern of 200 chars: <code class="language-plaintext highlighter-rouge">pattern_create 200 bof.txt</code></li>
  <li>Calculate the number of characters to do buffer overflow: <code class="language-plaintext highlighter-rouge">pattern_offset &lt;EIP register&gt;</code></li>
  <li>Get assembler code for function: <code class="language-plaintext highlighter-rouge">disas &lt;function&gt;</code>. The first line shows the address you must use to jump</li>
</ul>

    
  </section>

  <!-- Social media shares -->
  

<div class="share-buttons">
    <ul class="share-buttons">
        <li class="meta">Share</li>
        
        <li>
            <a href="https://www.facebook.com/sharer/sharer.php?u=https://www.agalera.eu/pentesting-tools/" target="_blank"
               title=" Facebook">
                <i class="fab fa-facebook-square fa-2x" aria-hidden="true"></i>
                <span class="sr-only">Share on Facebook</span>
            </a>
        </li>
         
        <li>
            <a href="https://twitter.com/intent/tweet?text=Pentesting+tools%20https%3A%2F%2Fwww.agalera.eu%2Fpentesting-tools%2F"
               target="_blank" title="">
                <i class="fab fa-twitter-square fa-2x" aria-hidden="true"></i>
                <span class="sr-only">Tweet</span>
            </a>
        </li>
         
        <li>
            <a href="https://www.tumblr.com/share?v=3&u=https://www.agalera.eu/pentesting-tools/&quote=Pentesting+tools%20%7C%20Adrian+Galera+blog&s="
               target="_blank" title=" Tumblr">
                <i class="fab fa-tumblr-square fa-2x" aria-hidden="true"></i>
                <span class="sr-only">Share on Tumblr</span>
            </a>
        </li>
         
        <li>
            <a href="https://pinterest.com/pin/create/button/?url=https://www.agalera.eu/pentesting-tools/&media=https://www.agalera.eu/assets/img/posts/hack-the-box-cheatsheet/featured.jpg$description=I+have+started+playing+around+in+https%3A%2F%2Fwww.hackthebox.com+platform+and+I%E2%80%99ll+use+this+article+to+save+all+the+pentesting+tools+I+am+learning.%0A%0A%0A%0A"
               target="_blank" title="">
                <i class="fab fa-pinterest-square fa-2x" aria-hidden="true"></i>
                <span class="sr-only">Pin it</span>
            </a>
        </li>
          
        <li>
            <a href="https://www.reddit.com/submit?url=https://www.agalera.eu/pentesting-tools/&title=Pentesting+tools%20%7C%20Adrian+Galera+blog"
               target="_blank" title=" Reddit">
                <i class="fab fa-reddit-square fa-2x" aria-hidden="true"></i>
                <span class="sr-only">Share on Reddit</span>
            </a>
        </li>
         
        <li>
            <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://www.agalera.eu/pentesting-tools/&title=Pentesting+tools%20%7C%20Adrian+Galera+blog&summary=&source=https://www.agalera.eu/pentesting-tools/"
               target="_blank" title=" LinkedIn">
                <i class="fab fa-linkedin fa-2x" aria-hidden="true"></i>
                <span class="sr-only">Share on LinkedIn</span>
            </a>
        </li>
          
        <li>
            <a href="mailto:?subject=Pentesting tools%20%7C%20Adrian Galera blog&body=https://www.agalera.eu/pentesting-tools/"
               target="_blank" title="">
                <i class="fas fa-envelope-square fa-2x" aria-hidden="true"></i>
                <span class="sr-only">Email</span></a>
        </li>
        
    </ul>
</div>




   <!-- Tag list -->
  
  


  <div class="tag-list">
    <ul>
      
        <li class="meta">Tags</li>
      

      
        <li><a class="button" href="/tags#hack-the-box">
          <p><i class="fas fa-tag fa-fw fa-sm"></i> hack-the-box</p>
        </a></li>
      
        <li><a class="button" href="/tags#hacking">
          <p><i class="fas fa-tag fa-fw fa-sm"></i> hacking</p>
        </a></li>
      
        <li><a class="button" href="/tags#linux">
          <p><i class="fas fa-tag fa-fw fa-sm"></i> linux</p>
        </a></li>
      
        <li><a class="button" href="/tags#pentesting">
          <p><i class="fas fa-tag fa-fw fa-sm"></i> pentesting</p>
        </a></li>
      
    </ul>
  </div>



</article>

<!-- Post navigation -->

<div id="post-nav">
    
    <div id="previous-post">
        <a alt="Pentesting playbook" href="/pentesting-playbook/">
            <p>Previous post</p>
            Pentesting playbook
        </a>
    </div>
    

    
    <div id="next-post">
        <a alt="Python cli application" href="/python-cli-application/">
            <p>Next post</p>
            Python cli application
        </a>
    </div>
    
</div>



<!--Utterances-->


<!-- Cusdis -->


<!-- Disqus -->


<!-- To change color of links in the page -->
<style>
  header#main {
      background-size: cover;
      background-repeat: no-repeat;
      background-position: center;
  }

  

  
  header#main { background-image: url('/assets/img/posts/hack-the-box-cheatsheet/featured.jpg'); }
  
</style>

    </div>
    <footer class="site-footer">
    <p class="text">
        </p>
            <div class="footer-icons">
                <ul>
                <!-- Social icons from Font Awesome, if enabled -->
                
<li>
    <a feed.xml href="/feed.xml"
       title="Follow RSS feed"
       target="_blank">
        <span class="fa-stack fa-lg">
            <i class="fas fa-circle fa-stack-2x"></i>
            <i class="fas fa-rss fa-stack-1x fa-inverse"></i>
        </span>
    </a>
</li>



    

    

    

    

    

    

    
        
        
        
        
        <li>
            <a href="https://github.com/adriangalera"
               title="Follow on Github"
               target="_blank"
               rel="noopener">
            <span class="fa-stack fa-lg">
              <i class="fas fa-circle fa-stack-2x"></i>
              <i class="fab fa-github fa-stack-1x fa-inverse"></i>
            </span>
            </a>
        </li>
    

    

    

    

    

    

    
        
        
        
        
        <li>
            <a href="https://www.linkedin.com/in/adriangalera"
               title="Follow on Linkedin"
               target="_blank"
               rel="noopener">
            <span class="fa-stack fa-lg">
              <i class="fas fa-circle fa-stack-2x"></i>
              <i class="fab fa-linkedin fa-stack-1x fa-inverse"></i>
            </span>
            </a>
        </li>
    

    
        
        
        
        
        <li>
            <a href="mailto:adrian.galera.87@gmail.com"
               title="Follow on Mail"
               target="_blank"
               rel="noopener">
            <span class="fa-stack fa-lg">
              <i class="fas fa-circle fa-stack-2x"></i>
              <i class="fas fa-envelope fa-stack-1x fa-inverse"></i>
            </span>
            </a>
        </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    


                </ul>
            </div>
</footer>



  </body>
</html>
